### Internet-Draft: Time Synchronization over QUIC (TSQ)

#### Author: Garrett McCollum

#### Status: Individual Submission (Draft)

#### Intended Status: Informational

#### Expires: n/a

---

### Abstract

This document proposes a modern, secure, and extensible time synchronization protocol designed to operate over the QUIC transport protocol. Known as TSQ (Time Synchronization over QUIC), this protocol aims to address the limitations of traditional NTP by leveraging QUIC's encryption, widespread UDP/443 acceptance, and multiplexed stream capabilities. TSQ is designed for contemporary deployment environments, including enterprise networks, cloud-native systems, containers, and mobile devices, where traditional UDP-based NTP struggles with security, scalability, or operational reliability.

---

### 1. Introduction

Time synchronization is foundational to modern computing. It underpins authentication systems, log correlation, distributed transactions, and more. NTP, the current standard, was designed in a different era and brings challenges related to security, deployment compatibility, and extensibility. TSQ is proposed as a new protocol built directly on top of QUIC, leveraging its modern transport features to provide secure, authenticated, and operationally-friendly time synchronization.

This document outlines the motivations, core design, threat model, and deployment considerations of TSQ. It is not intended to replace all use cases for NTP but to serve as a modern alternative where QUIC is viable and preferable.

---

### 2. Scope and Goals

TSQ is intended to:

* Provide secure and authenticated time synchronization
* Support modern deployment scenarios (e.g., ephemeral clients, mobile devices, cloud)
* Operate reliably in environments where legacy UDP-based ports (like 123) are blocked
* Be extensible and future-proof (e.g., post-quantum crypto readiness)
* Scale efficiently for enterprise and mid-size infrastructures

TSQ is **not** intended to:

* Replace NTP in high-precision, ultra-lightweight environments (e.g., embedded devices or atomic clock sync at microsecond-level)
* Immediately replace public time infrastructure (e.g., NTP pool) without further optimization

---

### 3. Protocol Overview

TSQ uses QUIC as its transport, establishing secure, short-lived connections for time synchronization exchanges. The basic flow consists of:

1. **Client establishes a QUIC connection** to a TSQ server over UDP/443.
2. **Client sends a TSQ Request** containing a nonce and timestamp request.
3. **Server responds with a TSQ Reply** containing:

   * Server time
   * Receive and send timestamps
   * Echoed nonce
   * Optional metadata (e.g., stratum, leap info)
4. **Client computes round-trip time (RTT) and clock offset**, then adjusts its local clock accordingly.

TSQ can transmit messages using either **QUIC streams** or **QUIC DATAGRAM frames**:

* **Streams** provide reliable, ordered delivery and are suitable for general enterprise and cloud deployments.
* **DATAGRAM frames** are unreliable and not retransmitted, which avoids hidden delays and improves accuracy in time-sensitive environments.

Clients MAY choose their preferred mode based on desired accuracy. Support for QUIC DATAGRAMs is OPTIONAL but RECOMMENDED for high-precision use cases.

---

### 4. Security and Threat Model

TSQ assumes the QUIC handshake provides:

* Mutual authentication (via certificates or raw public keys)
* Integrity and confidentiality of timestamp exchanges
* Protection from on-path attackers, replay attacks, and spoofing

Following RFC 7384 guidance, TSQ prioritizes:

* **Authenticity** of the time source
* **Integrity** of exchanged timestamps
* **Replay protection** via nonces and session bindings

TSQ does **not** require per-packet digital signatures unless offline auditability is needed. In such cases, optional fields can be signed using Ed25519 or HMAC.

**Optional Timestamp Signature:**
If auditability or external verification is required, TSQ supports optional digital signatures on the timestamp reply. One preferred approach is to compute two Ed25519 signatures during request handling:

* One just before obtaining the timestamp (which is discarded)
* One just after obtaining the timestamp (included in the reply)

This ensures the signing latency is symmetrical and consistent, preserving timing accuracy while still providing strong cryptographic assurance. Alternatively, implementations MAY use precomputed ECDSA ephemeral values with extreme care (single-use only), but this is discouraged due to the risk of private key leakage.

By default, TSQ relies on the integrity of the QUIC session and does not require additional cryptographic signing.

---

### 5. Scalability Considerations

To address scalability:

* TSQ connections can be short-lived and ephemeral, similar to HTTPS or DoQ
* QUIC supports 0-RTT and session resumption for frequent clients
* Servers can drop state after the sync if persistent connections are not required

This design is suited for enterprise and cloud-scale environments. Broader Internet-scale deployment would require performance benchmarking and further optimization.

---

### 6. Message Format (TLV)

**TSQ Request**:

* Type: 0x01
* Nonce (16 bytes)
* Extensions (optional)

**TSQ Response**:

* Type: 0x02
* Echoed Nonce (16 bytes)
* Server Time (Unix time + nanoseconds)
* Receive Timestamp
* Send Timestamp
* Optional metadata (stratum, leap flags)
* Optional Signature (if enabled)

All fields are sent over a QUIC stream or DATAGRAM frame and encrypted.

---

### 7. Use Cases

* Cloud infrastructure time sync (e.g., VMs, containers)
* Mobile clients roaming across networks
* Enterprise networks with existing QUIC-aware infrastructure
* Environments where UDP/123 is blocked or filtered by firewalls
* High-precision time sync requiring visibility into timing jitter or packet loss

---

### 8. Comparison to Existing Protocols

| Feature                    | NTP      | NTS (RFC 8915) | TSQ                 |
| -------------------------- | -------- | -------------- | ------------------- |
| Transport                  | UDP      | UDP + TLS/TCP  | QUIC over UDP/443   |
| Auth/Encryption            | Optional | Yes (complex)  | Always on (TLS 1.3) |
| Firewall Compatibility     | Poor     | Poor           | Excellent (UDP/443) |
| Extensibility              | Low      | Medium         | High (TLV-based)    |
| Suitable for Mobile        | No       | No             | Yes                 |
| Stateless Server Option    | Yes      | Yes            | Yes (short-lived)   |
| Precision Mode Support     | No       | No             | Yes (DATAGRAMs)     |

---

### 9. Next Steps

This document is a preliminary design proposal and not an official Internet-Draft. Next steps include:

* Gathering operator feedback on sync rates and resource constraints
* Refining the security and trust model in line with RFC 7384
* Implementing a proof-of-concept using existing QUIC libraries
* Submitting an official Internet-Draft if community interest develops

---

### Acknowledgments

Thanks to members of the QUIC and NTP mailing lists for their early feedback and constructive critique, particularly on scalability, precision tradeoffs, and threat modeling.

Special thanks to those who provided detailed input on QUIC resumption scalability, timestamp signing accuracy, and the use of QUIC DATAGRAM frames to improve precision in unreliable delivery scenarios.

---

### References

* RFC 8915: Network Time Security for the Network Time Protocol
* RFC 7384: Security Requirements of Time Protocols in Packet Switched Networks
* RFC 9000: QUIC: A UDP-Based Multiplexed and Secure Transport
* RFC 9221: The Datagram Extension to QUIC
* RFC 9308: Applicability of the QUIC Transport Protocol
* draft-ietf-dprive-dnsoquic: DNS over QUIC

---

*This document is not yet submitted to the IETF. Feedback welcome.*
